{% extends "base.html" %}

{% block content %}
<script src="{{ url_for('static', filename='scripts/change_status.js') }}"></script>
<div>
    <br>
    <p>
        <a  class="btn btn-primary i18n" name="back" href="{{ url_for('all_appointments',page=1) }}" ></a>
        <span style="margin: auto;font-size: 2rem"  class="lead i18n" name="detail"></span>
    </p>
<hr>
    <div>
    <table class="table table-hover">
     <thead>
             <tr>
                <td class="i18n" name="apt_id"></td>
                <td id="apt_id">{{ appointment.id }}</td>
            </tr>
     </thead>
      <tbody>
            <tr>
                <td class="i18n" name="submit_time"></td>
                <td>{{ appointment.datetime }}</td>
            </tr>

            <tr>
                <td class="i18n" name="apt_type"></td>
                {% if appointment.is_emergency == true %}
                    <td class="red i18n" name="emergency"></td>
                {% else %}
                    <td class="i18n" name="standard"></td>
                {% endif %}
            </tr>
            <tr>
                <td class="i18n" name="apt_status"></td>
                    {% if appointment.status == 'Canceled' %}
                        <td class="i18n" name="canceled"></td>
                    {% elif appointment.status == 'Pending' %}
                        <td class="i18n" name="pending"></td>
                    {% elif appointment.status == 'Finished' %}
                        <td class="i18n" name="finished"></td>
                    {% elif appointment.status == 'Confirmed' %}
                        <td class="i18n" name="confirmed"></td>
                    {% endif %}
            </tr>

            <tr>
                <td class="i18n" name="apt_location"></td>
                    {% if  appointment.loc  == 1 %}
                        <td class="i18n" name="beijing"></td>
                    {% elif  appointment.loc  == 2 %}
                        <td class="i18n" name="shanghai"></td>
                    {% elif appointment.loc  == 3 %}
                        <td class="i18n" name="chengdu"></td>
                    {% else %}
                    {% endif %}
            </tr>
            <tr>
                <td class="i18n" name="apt_desc"></td>
                    <td>{{ appointment.description }}</td>
            </tr>
            <tr>
                <td class="i18n" name="customer_name"></td>
                   <td>  <a href="{{ url_for('check_customer_info',customer_id=customer.id) }}" style="text-decoration:underline">{{ customer.username }}</a> </td>
            </tr>
            <tr>
                <td class="i18n" name="pet_name"></td>
                    <td>{{ pet.name }}</td>
            </tr>
            <tr>
                <td class="i18n" name="prefer_doctor"></td>
                    <td>{{ preferred.username }}</td>
            </tr>
            <tr>
                <td class="i18n" name="accept_change"></td>
                    {% if appointment.changeable == 1 %}
                        <td class="i18n" name="yes"></td>
                    {% else %}
                        <td class="red i18n" name="no"></td>
                    {% endif %}
            </tr>
            <tr>
                <td class="i18n" name="assigned_employee"></td>
                {% if assigned %}
                     <td><b>{{ assigned.username }}</b></td>
                {% else %}
                    <td class="i18n" name="none"></td>
                {% endif %}
            </tr>
      </tbody>
    </table>
    <br>
    {% if appointment.status == "Confirmed" and appointment.is_emergency == true%}
    <div style="margin: 0 auto">
        <form class="bs-example bs-example-form" role="form">
            <div class="row">
                <div class="col-lg-6" style="margin: 0 auto">
                    <span class="i18n" name="pet_status">:</span>
                    <div class="input-group"  style="margin: 20px">
                        <input style="font-size: 1.6rem" id="status" type="text" class="form-control" value="{{ appointment.pet_status }}">
                        <span id="check_update"></span>
                    </div><!-- /input-group -->
                </div><!-- /.col-lg-6 -->
            </div><!-- /.row -->
        </form>
    </div>
    <br>
{% endif %}
    <hr>
     <div class="center">
            {% if appointment.status == "Pending" %}
                <p>
                    <p  class="btn btn-primary i18n" name="reject" style="margin: 50px"  onclick="disp_confirm('Reject')"></p>
                    <p  class="btn btn-primary i18n" name="confirm" style="margin: 50px" onclick="disp_confirm('Confirm')"></p>
                </p>
            {% elif appointment.status == "Confirmed" %}
                <p>
                    <p  class="btn btn-primary i18n" name="cancel" style="margin: 50px" onclick="disp_confirm('Cancel')"></p>
                    <p  class="btn btn-primary i18n" name="finish" style="margin: 50px" onclick="disp_confirm('Finish')"></p>
                </p>
            {% endif %}
        </div>

</div>

<script>
function disp_confirm(opreation) {
  var r=confirm("Are you sure you want to "+opreation+" this appointment?")
      if (r==true) {
         window.location.href = "{{ url_for('update_appointment',apt=appointment.id) }}&operation="+opreation;
      }
  }
</script>
<style>
.success{
    color: green;
}
.failure{
    color: red;
}
</style>
{% endblock %}